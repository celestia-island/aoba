# Single Station - Master Mode - Input (04) Register Type
# Test ID: tui_master_input
# Station: ID=1, Type=Input, Address=0x0000, Length=10
#
# Test Data (3 Rounds for Integer Input Registers):
# Round 1 - Sequential: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
# Round 2 - Reverse: [9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
# Round 3 - Pseudo-random: [0x1234, 0x5678, 0x9ABC, 0xDEF0, 0x2468, 0xACE0, 0x1357, 0x9BDF, 0xFEDC, 0xBA98]

[manifest]
id = "single_station_master_input"
description = "Single station Master mode with Input registers"
station_id = 1
register_type = "Input"
start_address = 0x0000
register_count = 10
is_master = true

init_order = [
  "navigate_to_entry",
  "enter_config_panel",
  "navigate_to_business_config",
  "enter_modbus_panel",
  "create_station",
  "configure_station_fields",
  "edit_registers_round1",
  "save_configuration",
  "verify_port_enabled",
]

recycle_order = [
  "edit_registers_round2",
  "save_configuration",
  "verify_mock_data",
  "edit_registers_round3",
  "save_configuration",
  "verify_mock_data",
]

# Step 1: Navigate to Entry page
[[workflow.navigate_to_entry]]
description = "Initialize mock state for entry page"
mock_path = "$.page"
mock_set_value = { type = "entry" }

[[workflow.navigate_to_entry]]
description = "Ensure entry page port order"
mock_path = "$.port_order"
mock_set_value = ["/tmp/vcom1", "/tmp/vcom2"]

[[workflow.navigate_to_entry]]
description = "Wait for entry screen to populate ports"
sleep_ms = 1500

[[workflow.navigate_to_entry]]
description = "Initial navigation to entry page"
verify = "/tmp/vcom1"
at_line = 2

[[workflow.navigate_to_entry]]
verify = "/tmp/vcom2"
at_line = 3

# Step 2: Enter configuration panel
[[workflow.enter_config_panel]]
description = "Press Enter on selected port to enter config panel"
key = "Enter"

[[workflow.enter_config_panel]]
description = "Switch mock state to config panel"
mock_path = "$.page"
mock_set_value = { type = "config_panel" }

[[workflow.enter_config_panel]]
description = "Set config panel cursor to EnablePort"
mock_path = "$.page_state.config_panel.cursor"
mock_set_value = "EnablePort"

[[workflow.enter_config_panel]]
description = "Wait for config panel to render"
sleep_ms = 1500

[[workflow.enter_config_panel]]
verify = "Enable Port"
at_line = 2

# Step 3: Navigate to business configuration
[[workflow.navigate_to_business_config]]
description = "Navigate down to Business Configuration menu item"
key = "Down"
times = 2

[[workflow.navigate_to_business_config]]
description = "Highlight Business Configuration entry"
mock_path = "$.page_state.config_panel.cursor"
mock_set_value = "ProtocolConfig"

[[workflow.navigate_to_business_config]]
verify = "Enter Business Configuration"
at_line = 4

# Step 4: Enter Modbus panel
[[workflow.enter_modbus_panel]]
description = "Press Enter to enter Modbus dashboard"
key = "Enter"

[[workflow.enter_modbus_panel]]
description = "Switch mock state to Modbus dashboard"
mock_path = "$.page"
mock_set_value = { type = "modbus_dashboard" }

[[workflow.enter_modbus_panel]]
description = "Reset Modbus cursor to AddLine"
mock_path = "$.page_state.modbus_dashboard.cursor"
mock_set_value = { kind = "AddLine" }

[[workflow.enter_modbus_panel]]
verify = "ModBus Master/Slave Set"
at_line = 0

# Step 5: Create station
[[workflow.create_station]]
description = "Press Enter on 'Create Station' to create new station"
key = "Enter"

[[workflow.create_station]]
description = "Initialize master station structure"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters"
mock_set_value = [
  { station_id = 1, register_type = "Input", start_address = 0, register_count = 10, registers = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0] },
]

[[workflow.create_station]]
description = "Focus cursor on station header"
mock_path = "$.page_state.modbus_dashboard.cursor"
mock_set_value = { kind = "StationId", station_index = 0 }

[[workflow.create_station]]
verify = "#1 - ID: 1"
at_line = 5

# Step 6: Configure Station Fields
# After creating station, cursor is on StationId automatically
[[workflow.configure_station_fields]]
description = "Enter edit mode for Station ID"
key = "Enter"

[[workflow.configure_station_fields]]
description = "Clear existing value"
key = "Ctrl+a"

[[workflow.configure_station_fields]]
description = "Delete cleared content"
key = "Backspace"

[[workflow.configure_station_fields]]
description = "Type station ID value 1"
input = "decimal"
value = 1

[[workflow.configure_station_fields]]
description = "Confirm Station ID"
key = "Enter"

[[workflow.configure_station_fields]]
description = "Update Station ID in mock state"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].station_id"
mock_set_value = 1

# Navigate to Register Type using absolute positioning
[[workflow.configure_station_fields]]
description = "Return to top with Ctrl+PageUp"
key = "Ctrl+PageUp"

[[workflow.configure_station_fields]]
description = "Jump to station with PageDown (AddLine -> ModbusMode)"
key = "PageDown"

[[workflow.configure_station_fields]]
description = "Jump to station with PageDown (ModbusMode -> Station#1 StationId)"
key = "PageDown"

[[workflow.configure_station_fields]]
description = "Move to Register Type field (StationId -> RegisterType)"
key = "Down"

[[workflow.configure_station_fields]]
description = "Enter edit mode for Register Type"
key = "Enter"

[[workflow.configure_station_fields]]
description = "Cycle to Input register type (Holding->DiscreteInputs->Coils->Input)"
key = "Char(h)"
times = 3

[[workflow.configure_station_fields]]
description = "Confirm Register Type"
key = "Enter"

[[workflow.configure_station_fields]]
description = "Update Register Type in mock state"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].register_type"
mock_set_value = "Input"

# Navigate to Start Address using absolute positioning
[[workflow.configure_station_fields]]
description = "Return to top with Ctrl+PageUp"
key = "Ctrl+PageUp"

[[workflow.configure_station_fields]]
description = "Jump to station with PageDown (AddLine -> ModbusMode)"
key = "PageDown"

[[workflow.configure_station_fields]]
description = "Jump to station with PageDown (ModbusMode -> Station#1 StationId)"
key = "PageDown"

[[workflow.configure_station_fields]]
description = "Move to Register Type field"
key = "Down"

[[workflow.configure_station_fields]]
description = "Move to Start Address field"
key = "Down"

[[workflow.configure_station_fields]]
description = "Enter edit mode for Start Address"
key = "Enter"

[[workflow.configure_station_fields]]
description = "Clear existing value"
key = "Ctrl+a"

[[workflow.configure_station_fields]]
description = "Delete cleared content"
key = "Backspace"

[[workflow.configure_station_fields]]
description = "Type start address 0x0000"
input = "hex"
value = 0x0000

[[workflow.configure_station_fields]]
description = "Confirm Start Address"
key = "Enter"

[[workflow.configure_station_fields]]
description = "Update Start Address in mock state"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].start_address"
mock_set_value = 0

# Navigate to Register Count using absolute positioning
[[workflow.configure_station_fields]]
description = "Return to top with Ctrl+PageUp"
key = "Ctrl+PageUp"

[[workflow.configure_station_fields]]
description = "Jump to station with PageDown (AddLine -> ModbusMode)"
key = "PageDown"

[[workflow.configure_station_fields]]
description = "Jump to station with PageDown (ModbusMode -> Station#1 StationId)"
key = "PageDown"

[[workflow.configure_station_fields]]
description = "Move to Register Type field"
key = "Down"

[[workflow.configure_station_fields]]
description = "Move to Start Address field"
key = "Down"

[[workflow.configure_station_fields]]
description = "Move to Register Count field"
key = "Down"

[[workflow.configure_station_fields]]
description = "Enter edit mode for Register Count"
key = "Enter"

[[workflow.configure_station_fields]]
description = "Clear existing value"
key = "Ctrl+a"

[[workflow.configure_station_fields]]
description = "Delete cleared content"
key = "Backspace"

[[workflow.configure_station_fields]]
description = "Type register count 10"
input = "decimal"
value = 10

[[workflow.configure_station_fields]]
description = "Confirm Register Count"
key = "Enter"

[[workflow.configure_station_fields]]
description = "Update Register Count in mock state"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].register_count"
mock_set_value = 10

[[workflow.configure_station_fields]]
description = "Ensure registers array matches length"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers"
mock_set_value = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]

[[workflow.configure_station_fields]]
description = "Wait for register grid to appear"
sleep_ms = 1000

# Step 7: Edit Registers - Round 1 (Sequential 0-9)
# For integer registers, we need to enter edit mode, type the hex value, and confirm
[[workflow.edit_registers_round1]]
description = "Register 0 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round1]]
description = "Register 0 - Type value 0x0000"
input = "hex"
value = 0x0000

[[workflow.edit_registers_round1]]
description = "Register 0 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round1]]
description = "Update mock state register 0"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[0]"
mock_set_value = 0

[[workflow.edit_registers_round1]]
description = "Move to register 1"
key = "Right"

[[workflow.edit_registers_round1]]
description = "Register 1 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round1]]
description = "Register 1 - Type value 0x0001"
input = "hex"
value = 0x0001

[[workflow.edit_registers_round1]]
description = "Register 1 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round1]]
description = "Update mock state register 1"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[1]"
mock_set_value = 1

[[workflow.edit_registers_round1]]
description = "Move to register 2"
key = "Right"

[[workflow.edit_registers_round1]]
description = "Register 2 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round1]]
description = "Register 2 - Type value 0x0002"
input = "hex"
value = 0x0002

[[workflow.edit_registers_round1]]
description = "Register 2 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round1]]
description = "Update mock state register 2"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[2]"
mock_set_value = 2

[[workflow.edit_registers_round1]]
description = "Move to register 3"
key = "Right"

[[workflow.edit_registers_round1]]
description = "Register 3 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round1]]
description = "Register 3 - Type value 0x0003"
input = "hex"
value = 0x0003

[[workflow.edit_registers_round1]]
description = "Register 3 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round1]]
description = "Update mock state register 3"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[3]"
mock_set_value = 3

[[workflow.edit_registers_round1]]
description = "Verify first row of registers"
verify = "0x0000 0x0001 0x0002 0x0003"
at_line = 10

[[workflow.edit_registers_round1]]
description = "Move to register 4"
key = "Right"

[[workflow.edit_registers_round1]]
description = "Register 4 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round1]]
description = "Register 4 - Type value 0x0004"
input = "hex"
value = 0x0004

[[workflow.edit_registers_round1]]
description = "Register 4 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round1]]
description = "Update mock state register 4"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[4]"
mock_set_value = 4

[[workflow.edit_registers_round1]]
description = "Move to register 5"
key = "Right"

[[workflow.edit_registers_round1]]
description = "Register 5 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round1]]
description = "Register 5 - Type value 0x0005"
input = "hex"
value = 0x0005

[[workflow.edit_registers_round1]]
description = "Register 5 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round1]]
description = "Update mock state register 5"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[5]"
mock_set_value = 5

[[workflow.edit_registers_round1]]
description = "Move to register 6"
key = "Right"

[[workflow.edit_registers_round1]]
description = "Register 6 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round1]]
description = "Register 6 - Type value 0x0006"
input = "hex"
value = 0x0006

[[workflow.edit_registers_round1]]
description = "Register 6 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round1]]
description = "Update mock state register 6"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[6]"
mock_set_value = 6

[[workflow.edit_registers_round1]]
description = "Move to register 7"
key = "Right"

[[workflow.edit_registers_round1]]
description = "Register 7 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round1]]
description = "Register 7 - Type value 0x0007"
input = "hex"
value = 0x0007

[[workflow.edit_registers_round1]]
description = "Register 7 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round1]]
description = "Update mock state register 7"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[7]"
mock_set_value = 7

[[workflow.edit_registers_round1]]
description = "Verify second row of registers"
verify = "0x0004 0x0005 0x0006 0x0007"
at_line = 11

[[workflow.edit_registers_round1]]
description = "Move to register 8"
key = "Right"

[[workflow.edit_registers_round1]]
description = "Register 8 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round1]]
description = "Register 8 - Type value 0x0008"
input = "hex"
value = 0x0008

[[workflow.edit_registers_round1]]
description = "Register 8 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round1]]
description = "Update mock state register 8"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[8]"
mock_set_value = 8

[[workflow.edit_registers_round1]]
description = "Move to register 9"
key = "Right"

[[workflow.edit_registers_round1]]
description = "Register 9 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round1]]
description = "Register 9 - Type value 0x0009"
input = "hex"
value = 0x0009

[[workflow.edit_registers_round1]]
description = "Register 9 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round1]]
description = "Update mock state register 9"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[9]"
mock_set_value = 9

[[workflow.edit_registers_round1]]
description = "Verify third row of registers"
verify = "0x0008 0x0009 ______ ______"
at_line = 12

[[workflow.edit_registers_round1]]
description = "Return to top of panel"
key = "Ctrl+PageUp"

[[workflow.edit_registers_round1]]
description = "Reset cursor to station header"
mock_path = "$.page_state.modbus_dashboard.cursor"
mock_set_value = { kind = "StationId", station_index = 0 }

# Step 8: Save configuration
[[workflow.save_configuration]]
description = "Save configuration with Ctrl+S"
key = "Ctrl+s"

[[workflow.save_configuration]]
description = "Enable port in mock state"
mock_path = "$.ports['/tmp/vcom1'].enabled"
mock_set_value = true

[[workflow.save_configuration]]
description = "Set port state to OccupiedByThis"
mock_path = "$.ports['/tmp/vcom1'].state"
mock_set_value = { type = "occupied_by_this" }

[[workflow.save_configuration]]
description = "Wait for port to enable and stabilize"
sleep_ms = 5000

[[workflow.save_configuration]]
description = "Verify Running status indicator"
verify = "Running ‚óè"
at_line = 0

# Step 9: Verify port enabled
[[workflow.verify_port_enabled]]
description = "Check port is enabled in status"
mock_verify_path = "$.ports['/tmp/vcom1'].enabled"
mock_verify_value = true

[[workflow.verify_port_enabled]]
description = "Check port state is Running"
mock_verify_path = "$.ports['/tmp/vcom1'].state"
mock_verify_value = { type = "occupied_by_this" }

# Step 10: Edit Registers - Round 2 (Reverse: 9,8,7,6,5,4,3,2,1,0)
[[workflow.edit_registers_round2]]
description = "Return to register editing - press Ctrl+PageUp"
key = "Ctrl+PageUp"

[[workflow.edit_registers_round2]]
description = "Navigate down to registers"
key = "Down"
times = 5

[[workflow.edit_registers_round2]]
description = "Move focus to first register row"
key = "Down"

[[workflow.edit_registers_round2]]
description = "Register 0 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round2]]
description = "Register 0 - Clear and type 0x0009"
key = "Ctrl+a"

[[workflow.edit_registers_round2]]
key = "Backspace"

[[workflow.edit_registers_round2]]
input = "hex"
value = 9

[[workflow.edit_registers_round2]]
description = "Register 0 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round2]]
description = "Update mock state register 0"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[0]"
mock_set_value = 9

[[workflow.edit_registers_round2]]
description = "Move to register 1"
key = "Right"

[[workflow.edit_registers_round2]]
description = "Register 1 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round2]]
description = "Register 1 - Clear and type 0x0008"
key = "Ctrl+a"

[[workflow.edit_registers_round2]]
key = "Backspace"

[[workflow.edit_registers_round2]]
input = "hex"
value = 8

[[workflow.edit_registers_round2]]
description = "Register 1 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round2]]
description = "Update mock state register 1"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[1]"
mock_set_value = 8

[[workflow.edit_registers_round2]]
description = "Move to register 2"
key = "Right"

[[workflow.edit_registers_round2]]
description = "Register 2 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round2]]
description = "Register 2 - Clear and type 0x0007"
key = "Ctrl+a"

[[workflow.edit_registers_round2]]
key = "Backspace"

[[workflow.edit_registers_round2]]
input = "hex"
value = 7

[[workflow.edit_registers_round2]]
description = "Register 2 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round2]]
description = "Update mock state register 2"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[2]"
mock_set_value = 7

[[workflow.edit_registers_round2]]
description = "Move to register 3"
key = "Right"

[[workflow.edit_registers_round2]]
description = "Register 3 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round2]]
description = "Register 3 - Clear and type 0x0006"
key = "Ctrl+a"

[[workflow.edit_registers_round2]]
key = "Backspace"

[[workflow.edit_registers_round2]]
input = "hex"
value = 6

[[workflow.edit_registers_round2]]
description = "Register 3 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round2]]
description = "Update mock state register 3"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[3]"
mock_set_value = 6

[[workflow.edit_registers_round2]]
description = "Move to register 4"
key = "Right"

[[workflow.edit_registers_round2]]
description = "Register 4 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round2]]
description = "Register 4 - Clear and type 0x0005"
key = "Ctrl+a"

[[workflow.edit_registers_round2]]
key = "Backspace"

[[workflow.edit_registers_round2]]
input = "hex"
value = 5

[[workflow.edit_registers_round2]]
description = "Register 4 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round2]]
description = "Update mock state register 4"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[4]"
mock_set_value = 5

[[workflow.edit_registers_round2]]
description = "Move to register 5"
key = "Right"

[[workflow.edit_registers_round2]]
description = "Register 5 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round2]]
description = "Register 5 - Clear and type 0x0004"
key = "Ctrl+a"

[[workflow.edit_registers_round2]]
key = "Backspace"

[[workflow.edit_registers_round2]]
input = "hex"
value = 4

[[workflow.edit_registers_round2]]
description = "Register 5 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round2]]
description = "Update mock state register 5"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[5]"
mock_set_value = 4

[[workflow.edit_registers_round2]]
description = "Move to register 6"
key = "Right"

[[workflow.edit_registers_round2]]
description = "Register 6 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round2]]
description = "Register 6 - Clear and type 0x0003"
key = "Ctrl+a"

[[workflow.edit_registers_round2]]
key = "Backspace"

[[workflow.edit_registers_round2]]
input = "hex"
value = 3

[[workflow.edit_registers_round2]]
description = "Register 6 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round2]]
description = "Update mock state register 6"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[6]"
mock_set_value = 3

[[workflow.edit_registers_round2]]
description = "Move to register 7"
key = "Right"

[[workflow.edit_registers_round2]]
description = "Register 7 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round2]]
description = "Register 7 - Clear and type 0x0002"
key = "Ctrl+a"

[[workflow.edit_registers_round2]]
key = "Backspace"

[[workflow.edit_registers_round2]]
input = "hex"
value = 2

[[workflow.edit_registers_round2]]
description = "Register 7 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round2]]
description = "Update mock state register 7"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[7]"
mock_set_value = 2

[[workflow.edit_registers_round2]]
description = "Move to register 8"
key = "Right"

[[workflow.edit_registers_round2]]
description = "Register 8 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round2]]
description = "Register 8 - Clear and type 0x0001"
key = "Ctrl+a"

[[workflow.edit_registers_round2]]
key = "Backspace"

[[workflow.edit_registers_round2]]
input = "hex"
value = 1

[[workflow.edit_registers_round2]]
description = "Register 8 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round2]]
description = "Update mock state register 8"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[8]"
mock_set_value = 1

[[workflow.edit_registers_round2]]
description = "Move to register 9"
key = "Right"

[[workflow.edit_registers_round2]]
description = "Register 9 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round2]]
description = "Register 9 - Clear and type 0x0000"
key = "Ctrl+a"

[[workflow.edit_registers_round2]]
key = "Backspace"

[[workflow.edit_registers_round2]]
input = "hex"
value = 0

[[workflow.edit_registers_round2]]
description = "Register 9 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round2]]
description = "Update mock state register 9"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[9]"
mock_set_value = 0

[[workflow.edit_registers_round2]]
description = "Verify reverse sequence"
verify = "0x0009 0x0008 0x0007 0x0006"
at_line = 10

[[workflow.edit_registers_round2]]
description = "Return to top of panel"
key = "Ctrl+PageUp"

[[workflow.edit_registers_round2]]
description = "Reset cursor to station header"
mock_path = "$.page_state.modbus_dashboard.cursor"
mock_set_value = { kind = "StationId", station_index = 0 }

# Step 11: Edit Registers - Round 3 (Pseudo-random hex values)
[[workflow.edit_registers_round3]]
description = "Navigate down to registers"
key = "Down"
times = 5

[[workflow.edit_registers_round3]]
description = "Move focus to first register row"
key = "Down"

[[workflow.edit_registers_round3]]
description = "Register 0 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round3]]
description = "Register 0 - Clear and type 0x1234"
key = "Ctrl+a"

[[workflow.edit_registers_round3]]
key = "Backspace"

[[workflow.edit_registers_round3]]
input = "hex"
value = 4660

[[workflow.edit_registers_round3]]
description = "Register 0 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round3]]
description = "Update mock state register 0"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[0]"
mock_set_value = 4660

[[workflow.edit_registers_round3]]
description = "Move to register 1"
key = "Right"

[[workflow.edit_registers_round3]]
description = "Register 1 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round3]]
description = "Register 1 - Clear and type 0x5678"
key = "Ctrl+a"

[[workflow.edit_registers_round3]]
key = "Backspace"

[[workflow.edit_registers_round3]]
input = "hex"
value = 22136

[[workflow.edit_registers_round3]]
description = "Register 1 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round3]]
description = "Update mock state register 1"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[1]"
mock_set_value = 22136

[[workflow.edit_registers_round3]]
description = "Move to register 2"
key = "Right"

[[workflow.edit_registers_round3]]
description = "Register 2 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round3]]
description = "Register 2 - Clear and type 0x9ABC"
key = "Ctrl+a"

[[workflow.edit_registers_round3]]
key = "Backspace"

[[workflow.edit_registers_round3]]
input = "hex"
value = 39612

[[workflow.edit_registers_round3]]
description = "Register 2 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round3]]
description = "Update mock state register 2"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[2]"
mock_set_value = 39612

[[workflow.edit_registers_round3]]
description = "Move to register 3"
key = "Right"

[[workflow.edit_registers_round3]]
description = "Register 3 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round3]]
description = "Register 3 - Clear and type 0xDEF0"
key = "Ctrl+a"

[[workflow.edit_registers_round3]]
key = "Backspace"

[[workflow.edit_registers_round3]]
input = "hex"
value = 57072

[[workflow.edit_registers_round3]]
description = "Register 3 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round3]]
description = "Update mock state register 3"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[3]"
mock_set_value = 57072

[[workflow.edit_registers_round3]]
description = "Move to register 4"
key = "Right"

[[workflow.edit_registers_round3]]
description = "Register 4 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round3]]
description = "Register 4 - Clear and type 0x2468"
key = "Ctrl+a"

[[workflow.edit_registers_round3]]
key = "Backspace"

[[workflow.edit_registers_round3]]
input = "hex"
value = 9320

[[workflow.edit_registers_round3]]
description = "Register 4 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round3]]
description = "Update mock state register 4"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[4]"
mock_set_value = 9320

[[workflow.edit_registers_round3]]
description = "Move to register 5"
key = "Right"

[[workflow.edit_registers_round3]]
description = "Register 5 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round3]]
description = "Register 5 - Clear and type 0xACE0"
key = "Ctrl+a"

[[workflow.edit_registers_round3]]
key = "Backspace"

[[workflow.edit_registers_round3]]
input = "hex"
value = 44256

[[workflow.edit_registers_round3]]
description = "Register 5 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round3]]
description = "Update mock state register 5"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[5]"
mock_set_value = 44256

[[workflow.edit_registers_round3]]
description = "Move to register 6"
key = "Right"

[[workflow.edit_registers_round3]]
description = "Register 6 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round3]]
description = "Register 6 - Clear and type 0x1357"
key = "Ctrl+a"

[[workflow.edit_registers_round3]]
key = "Backspace"

[[workflow.edit_registers_round3]]
input = "hex"
value = 4951

[[workflow.edit_registers_round3]]
description = "Register 6 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round3]]
description = "Update mock state register 6"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[6]"
mock_set_value = 4951

[[workflow.edit_registers_round3]]
description = "Move to register 7"
key = "Right"

[[workflow.edit_registers_round3]]
description = "Register 7 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round3]]
description = "Register 7 - Clear and type 0x9BDF"
key = "Ctrl+a"

[[workflow.edit_registers_round3]]
key = "Backspace"

[[workflow.edit_registers_round3]]
input = "hex"
value = 39903

[[workflow.edit_registers_round3]]
description = "Register 7 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round3]]
description = "Update mock state register 7"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[7]"
mock_set_value = 39903

[[workflow.edit_registers_round3]]
description = "Move to register 8"
key = "Right"

[[workflow.edit_registers_round3]]
description = "Register 8 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round3]]
description = "Register 8 - Clear and type 0xFEDC"
key = "Ctrl+a"

[[workflow.edit_registers_round3]]
key = "Backspace"

[[workflow.edit_registers_round3]]
input = "hex"
value = 65244

[[workflow.edit_registers_round3]]
description = "Register 8 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round3]]
description = "Update mock state register 8"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[8]"
mock_set_value = 65244

[[workflow.edit_registers_round3]]
description = "Move to register 9"
key = "Right"

[[workflow.edit_registers_round3]]
description = "Register 9 - Enter edit mode"
key = "Enter"

[[workflow.edit_registers_round3]]
description = "Register 9 - Clear and type 0xBA98"
key = "Ctrl+a"

[[workflow.edit_registers_round3]]
key = "Backspace"

[[workflow.edit_registers_round3]]
input = "hex"
value = 47768

[[workflow.edit_registers_round3]]
description = "Register 9 - Confirm value"
key = "Enter"

[[workflow.edit_registers_round3]]
description = "Update mock state register 9"
mock_path = "$.ports['/tmp/vcom1'].modbus_masters[0].registers[9]"
mock_set_value = 47768

[[workflow.edit_registers_round3]]
description = "Verify pseudo-random pattern"
verify = "0x1234 0x5678 0x9ABC 0xDEF0"
at_line = 10

[[workflow.edit_registers_round3]]
description = "Return to top of panel"
key = "Ctrl+PageUp"

[[workflow.edit_registers_round3]]
description = "Reset cursor to station header"
mock_path = "$.page_state.modbus_dashboard.cursor"
mock_set_value = { kind = "StationId", station_index = 0 }

# Step 12: Verify mock data (used in recycle)
[[workflow.verify_mock_data]]
description = "Verify all register values in mock state"
mock_verify_path = "$.ports['/tmp/vcom1'].modbus_masters[0].register_count"
mock_verify_value = 10

[[workflow.verify_mock_data]]
description = "Verify station configuration"
mock_verify_path = "$.ports['/tmp/vcom1'].modbus_masters[0].station_id"
mock_verify_value = 1
